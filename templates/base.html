<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <title>BGCM</title>

    <!-- Pico.css -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"
    />
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='css/main.css') }}"
    />
  </head>
  <body>
    <main
      id="page"
      class="container"
      hx-boost="true"
      hx-target="#page"
      hx-select="#page"
    >
      {% block page_header %}{% endblock %}
      {% block content %}{% endblock %}
    </main>

    <script>
      const THEME_KEY = "bgcm-theme";

      const applyTheme = (theme) => {
        const isDark = theme === "dark";
        document.body.classList.toggle("dark", isDark);
        const toggle = document.querySelector(".theme-toggle");
        if (toggle) {
          toggle.setAttribute("aria-pressed", String(isDark));
          toggle.setAttribute(
            "aria-label",
            isDark ? "Cambiar a modo claro" : "Cambiar a modo oscuro"
          );
          toggle.setAttribute(
            "title",
            isDark ? "Cambiar a modo claro" : "Cambiar a modo oscuro"
          );
        }
      };

      const storedTheme = localStorage.getItem(THEME_KEY);
      if (storedTheme) {
        applyTheme(storedTheme);
      } else if (window.matchMedia("(prefers-color-scheme: dark)").matches) {
        applyTheme("dark");
      } else {
        applyTheme("light");
      }

      document.addEventListener("DOMContentLoaded", () => {
        const toggle = document.querySelector(".theme-toggle");
        if (!toggle) return;

        toggle.addEventListener("click", () => {
          const nextTheme = document.body.classList.contains("dark")
            ? "light"
            : "dark";
          localStorage.setItem(THEME_KEY, nextTheme);
          applyTheme(nextTheme);
        });
      });
    </script>
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>
  </body>
</html>
